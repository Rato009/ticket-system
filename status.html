<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ•´ç†åˆ¸ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</title>
  <style>
    body { font-family: sans-serif; padding: 2em; }
  </style>
  
</head>
<body>
  <h1>ğŸ“‹ ã‚ãªãŸã®æ•´ç†åˆ¸çŠ¶æ³</h1>
  <p id="myTicket"></p>
  <p id="currentNumber"></p>
  <p id="waitCount"></p>

  <script>
    const params = new URLSearchParams(window.location.search);
    const myTicket = params.get("ticket");

    if (!myTicket) {
      document.body.innerHTML = "<p>æ•´ç†åˆ¸æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚</p>";
    } else {
      document.getElementById("myTicket").innerText = `ã‚ãªãŸã®ç•ªå·ï¼š${myTicket}`;

      const current = localStorage.getItem("currentTicket") || "T-0";
      document.getElementById("currentNumber").innerText = `ç¾åœ¨ã®å‘¼å‡ºç•ªå·ï¼š${current}`;

      const queue = JSON.parse(localStorage.getItem("queue") || "[]");
      const currentIndex = queue.indexOf(current);
      const myIndex = queue.indexOf(myTicket);

      if (myIndex === -1) {
        document.getElementById("waitCount").innerText = "ã“ã®æ•´ç†åˆ¸ã¯ç¾åœ¨ã®å¾…ã¡ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚";
      } else if (myIndex <= currentIndex) {
        document.getElementById("waitCount").innerText = "ã¾ã‚‚ãªãå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚";
      } else {
        const waitCount = myIndex - currentIndex;
        document.getElementById("waitCount").innerText = `ã‚ãªãŸã®å‰ã« ${waitCount} äººå¾…ã£ã¦ã„ã¾ã™ã€‚`;
      }
    }
  </script>
</body>
</html>
